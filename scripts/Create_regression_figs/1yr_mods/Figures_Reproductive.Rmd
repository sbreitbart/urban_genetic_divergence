# Set up notebook
## Load libraries and add functions
```{r}
source("libraries.R")
source("functions.R")
```

## Import data
```{r}
source(knitr::purl("scripts/Model_diagnostics/Model_diagnostics_1yr_mods.Rmd", quiet=TRUE))
```

# Create ggpredict objects
## Flowering success
### Gradient
```{r}
# city_dist
repr.m1
flsucc_gradient_01_pred <- ggeffects::ggpredict(repr.m1,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m1_u
flsucc_gradient_02_pred <- ggeffects::ggpredict(repr.m1_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}
# city_dist
repr.tr.m1
flsucc_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m1,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m1_u
flsucc_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m1_u,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```

## Mean flower count/inflor
### Gradient
```{r}

# city_dist
repr.m2
flowers_gradient_01_pred <- ggeffects::ggpredict(repr.m2,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m2_u
flowers_gradient_02_pred <- ggeffects::ggpredict(repr.m2_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()

```

### Urban Subtransects
```{r}
# city_dist
repr.tr.m2
flowers_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m2,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m2_u
flowers_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m2_u,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```

## Mean flower size/inflorescence
### Gradient
```{r}

# city_dist
repr.m3
flsize_gradient_01_pred <- ggeffects::ggpredict(repr.m3,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m3_u
flsize_gradient_02_pred <- ggeffects::ggpredict(repr.m3_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}

# city_dist
repr.tr.m3
flsize_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m3,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()


# urb_score
repr.tr.m3_u
flsize_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m3_u,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```


## Flowering time
### Gradient
```{r}

# city_dist
repr.m4
fltime_gradient_01_pred <- ggeffects::ggpredict(repr.m4,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m4_u
fltime_gradient_02_pred <- ggeffects::ggpredict(repr.m4_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}

# city_dist
repr.tr.m4
fltime_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m4,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m4_u
fltime_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m4_u,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```

## Flowering start
### Gradient
```{r}
# city_dist
repr.m5
flstart_gradient_01_pred <- ggeffects::ggpredict(repr.m5,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m5_u
flstart_gradient_02_pred <- ggeffects::ggpredict(repr.m5_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()

```

### Urban Subtransects
```{r}

# city_dist
repr.tr.m5
flstart_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m5,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m5_u 
flstart_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m5_u,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()


```


## Pollinaria removed
### Gradient
```{r}

# city_dist
repr.m9 # sqrt transformed
poll_gradient_01_pred <- ggeffects::ggpredict(repr.m9 ,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m9_u  # sqrt transformed
poll_gradient_02_pred <- ggeffects::ggpredict(repr.m9_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}

# city_dist
repr.tr.m9  # sqrt transformed
poll_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m9 ,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m9_u  # sqrt transformed
poll_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m9_u ,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```


## Pods
### Gradient
```{r}

# city_dist
repr.m6 
pods_gradient_01_pred <- ggeffects::ggpredict(repr.m6 ,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m6_u 
pods_gradient_02_pred <- ggeffects::ggpredict(repr.m6_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}

# city_dist
repr.tr.m6 
pods_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m6 ,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m6_u 
pods_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m6_u ,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```


## Date of first pod
### Gradient
```{r}

flowering$first_foll_minus200 <- (flowering$Julian_first_follicle- 200)

repr.m7 <- make_1yrmod(
  update(first_pods_mods_best_c[[1]],
         first_foll_minus200 ~ .),
  "2022", flowering)

repr.m7_u <- make_1yrmod(
  update(first_pods_mods_best_u[[1]],
         first_foll_minus200 ~ .),
  "2022", flowering)

# city_dist
repr.m7  # -200
firstpods_gradient_01_pred <- ggeffects::ggpredict(repr.m7 ,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m7_u # -200
firstpods_gradient_02_pred <- ggeffects::ggpredict(repr.m7_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}
repr.tr.m7_ggpred <- update(repr.tr.m7,
         first_foll_minus200 ~ .)

repr.tr.m7_u_ggpred <- update(repr.tr.m7_u,
         first_foll_minus200 ~ .)

# city_dist
repr.tr.m7 # -200
firstpods_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m7_ggpred ,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m7_u # -200
firstpods_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m7_u_ggpred ,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```


## Peduncles (Inflorescences)
### Gradient
```{r}

# city_dist
repr.m8 
peduncles_gradient_01_pred <- ggeffects::ggpredict(repr.m8 ,
                                   terms = c("City_dist"),
                                   type = "fe") %>%
  as.data.frame() 

# urb_score
repr.m8_u 
peduncles_gradient_02_pred <- ggeffects::ggpredict(repr.m8_u,
                                   terms = c("Urb_score"),
                                   type = "fe") %>%
  as.data.frame()
```

### Urban Subtransects
```{r}

# city_dist
repr.tr.m8 # SQUARED
peduncles_urbsubs_01_pred <- ggeffects::ggpredict(repr.tr.m8 ,
                                   terms = c("City_dist", "Transect_ID"),
                                   type = "fe") %>%
  as.data.frame()

# urb_score
repr.tr.m8_u 
peduncles_urbsubs_02_pred <- ggeffects::ggpredict(repr.tr.m8_u ,
                                   terms = c("Urb_score", "Transect_ID"),
                                   type = "fe")
```


# Create regression plots
## Gradient
### City_dist
```{r}
# Flowering success-----
ggpred_Q1.citydist_flsucc <- 
ggplot(flsucc_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Flowering success") +
  ylim(0.1, NA) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m1) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_flsucc



# Flowers per inflorescence-----
ggpred_Q1.citydist_flowers <- 
ggplot(flowers_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Flowers per inflorescence") +
  ylim(15, 45) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m2) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_flowers


# Flower size-----
ggpred_Q1.citydist_flsize <- 
ggplot(flsize_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = expression("Flower size (" ~ mm^{3}~")")) +
#  ylim(NA, 39) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m3) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_flsize



# Flowering duration-----
ggpred_Q1.citydist_fltime <- 
ggplot(fltime_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Flowering duration (days)") +
  ylim(7,NA) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m4) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_fltime



# Flowering start-----
ggpred_Q1.citydist_flstart <- 
ggplot(flstart_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Date of first flower\n (Day 0 = June 20)") +
 # ylim(NA, 22) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m5) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_flstart


# Pollinaria removed-----
ggpred_Q1.citydist_poll <- 
ggplot(poll_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Pollinaria removed") +
  ylim(0, NA) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m9) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_poll


# Pods-----
ggpred_Q1.citydist_pods <- 
ggplot(pods_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Follicles") +
  ylim(2.5, NA) +
#  scale_y_continuous(breaks = seq(3, 12, by = 2)) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m6) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_pods



# First pods-----
ggpred_Q1.citydist_firstpods <- 
ggplot(firstpods_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Date of first follicle\n (Day 0 = July 20)") +
  ylim(8, 18) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m7) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_firstpods


# Inflorescences (peduncles)-----
ggpred_Q1.citydist_peduncles <- 
ggplot(peduncles_gradient_01_pred) +
  rep_geoms +
  labs(x = "Distance to Urban Center (km)",
       y = "Inflorescences") +
  ylim(3, NA) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Distance: p = ", tidy_anova(repr.m8) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.citydist_peduncles

```

### Urb_score
```{r}
# Flowering success-----
ggpred_Q1.urbscore_flsucc <- 
ggplot(flsucc_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Flowering success") +
 ylim(0.1, 0.4) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m1_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_flsucc



# Flowers per inflorescence-----
ggpred_Q1.urbscore_flowers <- 
ggplot(flowers_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Flowers per inflorescence") +
 ylim(15, NA) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m2_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_flowers




# Flower size-----
ggpred_Q1.urbscore_flsize <- 
ggplot(flsize_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = expression("Flower size (" ~ mm^{3}~")")) +
 ylim(32, NA) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m3_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_flsize


# Flowering duration-----
ggpred_Q1.urbscore_fltime <- 
ggplot(fltime_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Flowering duration (days)") +
 ylim(6.5, NA) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m4_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_fltime



# Flowering start-----
ggpred_Q1.urbscore_flstart <- 
ggplot(flstart_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Date of first flower\n (Day 0 = June 20)") +
 ylim(14, 22) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m5_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_flstart


# Pollinaria removed-----
ggpred_Q1.urbscore_poll <- 
ggplot(poll_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Pollinaria removed") +
 ylim(0, 1) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m9_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_poll



# Pods-----
ggpred_Q1.urbscore_pods <- 
ggplot(pods_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Follicles") +
 ylim(2, 12) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m6_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_pods



# First pods-----
ggpred_Q1.urbscore_firstpods <- 
ggplot(firstpods_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Date of first follicle\n (Day 0 = July 20)") +
 ylim(9, 16) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m7_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_firstpods


# Inflorescences (peduncles)-----
ggpred_Q1.urbscore_peduncles <- 
ggplot(peduncles_gradient_02_pred) +
  rep_geoms +
  labs(x = "Urbanization Score",
       y = "Inflorescences") +
  ylim(3, NA) +
    xlim(4, -4) +
  theme_1() +
  
# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.08,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.m8_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q1.urbscore_peduncles

```

## Urban Subtransects
### City_dist
```{r}
# Flowering success-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flsucc_urbsubs_01_pred$group <- factor(flsucc_urbsubs_01_pred$group,
                                   levels(flsucc_urbsubs_01_pred$group)[c(2,1)])
levels(flsucc_urbsubs_01_pred$group)

ggpred_Q2.citydist_succ <-
ggplot(flsucc_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Flowering success",
       color = "Transect",
       fill = "Transect") +
  ylim(0, 0.5) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.96,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m1) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m1) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_succ


# Flowers per inflorescence-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flowers_urbsubs_01_pred$group <- factor(flowers_urbsubs_01_pred$group,
                                   levels(flowers_urbsubs_01_pred$group)[c(2,1)])
levels(flowers_urbsubs_01_pred$group)

ggpred_Q2.citydist_flowers <-
ggplot(flowers_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Flowers per inflorescence",
       color = "Transect",
       fill = "Transect") +
  ylim(10, 50) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m2) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m2) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_flowers



# Flower size-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flsize_urbsubs_01_pred$group <- factor(flsize_urbsubs_01_pred$group,
                                   levels(flsize_urbsubs_01_pred$group)[c(2,1)])
levels(flsize_urbsubs_01_pred$group)


ggpred_Q2.citydist_flsize <-
ggplot(flsize_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = expression("Flower size (" ~ mm^{3}~")"),
       color = "Transect",
       fill = "Transect") +
  ylim(30, 45) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m3) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m3) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_flsize



# Flowering duration-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
fltime_urbsubs_01_pred$group <- factor(fltime_urbsubs_01_pred$group,
                                   levels(fltime_urbsubs_01_pred$group)[c(2,1)])
levels(fltime_urbsubs_01_pred$group)

ggpred_Q2.citydist_fltime <-
ggplot(fltime_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Flowering duration (days)",
       color = "Transect",
       fill = "Transect") +
#  ylim(0, NA) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.95, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m4) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.95, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m4) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_fltime

# Flowering start-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flstart_urbsubs_01_pred$group <- factor(flstart_urbsubs_01_pred$group,
                                   levels(flstart_urbsubs_01_pred$group)[c(2,1)])
levels(flstart_urbsubs_01_pred$group)

ggpred_Q2.citydist_flstart <-
ggplot(flstart_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Date of first flower\n (Day 0 = June 20)",
       color = "Transect",
       fill = "Transect") +
  ylim(12, 24.5) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.96,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m5) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m5) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_flstart


# Pollinaria removed-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
poll_urbsubs_01_pred$group <- factor(poll_urbsubs_01_pred$group,
                                   levels(poll_urbsubs_01_pred$group)[c(2,1)])
levels(poll_urbsubs_01_pred$group)

ggpred_Q2.citydist_poll <-
ggplot(poll_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Pollinaria removed",
       color = "Transect",
       fill = "Transect") +
  ylim(0, 1) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m9) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m9) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_poll



# Pods-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
pods_urbsubs_01_pred$group <- factor(pods_urbsubs_01_pred$group,
                                   levels(pods_urbsubs_01_pred$group)[c(2,1)])
levels(pods_urbsubs_01_pred$group)

ggpred_Q2.citydist_pods <-
ggplot(pods_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Follicles",
       color = "Transect",
       fill = "Transect") +
  ylim(0, 30) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m6) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m6) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.79,
                    label = paste0(" D x S: p = ",
                                   tidy_anova(repr.tr.m6) %>%
dplyr::filter(Predictor == "Distance to City Center x Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_pods



# First pods-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
firstpods_urbsubs_01_pred$group <- factor(firstpods_urbsubs_01_pred$group,
                                   levels(firstpods_urbsubs_01_pred$group)[c(2,1)])
levels(firstpods_urbsubs_01_pred$group)

ggpred_Q2.citydist_firstpods <-
ggplot(firstpods_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = "Date of first follicle\n (Day 0 = July 20)",
       color = "Transect",
       fill = "Transect") +
  ylim(5, 20) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m7) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m7) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_firstpods



# Inflorescences (peduncles)-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
peduncles_urbsubs_01_pred$group <- factor(peduncles_urbsubs_01_pred$group,
                                   levels(peduncles_urbsubs_01_pred$group)[c(2,1)])
levels(peduncles_urbsubs_01_pred$group)


ggpred_Q2.citydist_peduncles <-
ggplot(peduncles_urbsubs_01_pred) +
  labs(x = "Distance to Urban Center (km)",
       y = expression("Inflorescences" ^2),
       color = "Transect",
       fill = "Transect") +
  ylim(NA, 120) +
  xlim(0, NA) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.95, npcy = 0.97,
                    label = paste0(" Distance: p = ", tidy_anova(repr.tr.m8) %>%
dplyr::filter(Predictor == "Distance to City Center") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.95, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m8) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.citydist_peduncles
```

### Urb score
```{r}
# Flowering success-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flsucc_urbsubs_02_pred$group <- factor(flsucc_urbsubs_02_pred$group,
                                   levels(flsucc_urbsubs_02_pred$group)[c(2,1)])
levels(flsucc_urbsubs_02_pred$group)


ggpred_Q2.urbsubs_flsucc <-
ggplot(flsucc_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Flowering success",
       color = "Transect",
       fill = "Transect") +
  ylim(0, 0.8) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m1_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m1_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.79,
                    label = paste0(" U x S: p = ", tidy_anova(repr.tr.m1_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbsubs_flsucc


# Flowers per inflorescence-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flowers_urbsubs_02_pred$group <- factor(flowers_urbsubs_02_pred$group,
                                   levels(flowers_urbsubs_02_pred$group)[c(2,1)])
levels(flowers_urbsubs_02_pred$group)


ggpred_Q2.urbsubs_flowers <-
ggplot(flowers_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Flowers per inflorescence",
       color = "Transect",
       fill = "Transect") +
#  ylim(35, 55) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m2_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m2_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbsubs_flowers



# Flower size-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
flsize_urbsubs_02_pred$group <- factor(flsize_urbsubs_02_pred$group,
                                   levels(flsize_urbsubs_02_pred$group)[c(2,1)])
levels(flsize_urbsubs_02_pred$group)

ggpred_Q2.urbsubs_flsize <-
ggplot(flsize_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = expression("Flower size (" ~ mm^{3}~")"),
       color = "Transect",
       fill = "Transect") +
  ylim(NA, 42.5) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m3_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m3_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) 

ggpred_Q2.urbsubs_flsize


# Flowering duration-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
fltime_urbsubs_02_pred$group <- factor(fltime_urbsubs_02_pred$group,
                                   levels(fltime_urbsubs_02_pred$group)[c(2,1)])
levels(fltime_urbsubs_02_pred$group)

ggpred_Q2.urbsubs_fltime <-
ggplot(fltime_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Flowering duration (days)",
       color = "Transect",
       fill = "Transect") +
 ylim(0, 50) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m4_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m4_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.79,
                    label = paste0(" U x S: p = ", tidy_anova(repr.tr.m4_u) %>%
dplyr::filter(Predictor == "Urbanization Score x Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbsubs_fltime


# Flowering start-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first

flstart_urbsubs_02_pred$group <- factor(flstart_urbsubs_02_pred$group,
                                   levels(flstart_urbsubs_02_pred$group)[c(2,1)])
levels(flstart_urbsubs_02_pred$group)

ggpred_Q2.urbsubs_flstart <-
ggplot(flstart_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Date of first flower\n (Day 0 = June 20)",
       color = "Transect",
       fill = "Transect") +
  ylim(NA, 25) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +
  theme(legend.position = "none") +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m5_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5)  +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m5_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) 

ggpred_Q2.urbsubs_flstart



# Pollinaria removed-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
poll_urbsubs_02_pred$group <- factor(poll_urbsubs_02_pred$group,
                                   levels(poll_urbsubs_02_pred$group)[c(2,1)])
levels(poll_urbsubs_02_pred$group)


ggpred_Q2.urbsubs_poll <-
ggplot(poll_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Pollinaria removed",
       color = "Transect",
       fill = "Transect") +
  ylim(0,1) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m9_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m9_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbsubs_poll



# Pods-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
pods_urbsubs_02_pred$group <- factor(pods_urbsubs_02_pred$group,
                                   levels(pods_urbsubs_02_pred$group)[c(2,1)])
levels(pods_urbsubs_02_pred$group)


ggpred_Q2.urbsubs_pods <-
ggplot(pods_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Follicles",
       color = "Transect",
       fill = "Transect") +
  ylim(0,NA) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m6_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m6_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.79,
                    label = paste0(" U x S: p = ", tidy_anova(repr.tr.m6_u) %>%
dplyr::filter(Predictor == "Urbanization Score x Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbsubs_pods



# First pods-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
firstpods_urbsubs_02_pred$group <- factor(firstpods_urbsubs_02_pred$group,
                                   levels(firstpods_urbsubs_02_pred$group)[c(2,1)])
levels(firstpods_urbsubs_02_pred$group)


ggpred_Q2.urbscore_firstpods <-
ggplot(firstpods_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Date of first follicle\n (Day 0 = July 20)",
       color = "Transect",
       fill = "Transect") +
  ylim(NA, 28) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m7_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m7_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.79,
                    label = paste0(" U x S: p = ", tidy_anova(repr.tr.m7_u) %>%
dplyr::filter(Predictor == "Urbanization Score x Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbscore_firstpods


# Inflorescences (peduncles)-----
## factors (transects) for this object are North, then South. To keep legend consistent, reorder levels first
peduncles_urbsubs_02_pred$group <- factor(peduncles_urbsubs_02_pred$group,
                                   levels(peduncles_urbsubs_02_pred$group)[c(2,1)])
levels(peduncles_urbsubs_02_pred$group)

ggpred_Q2.urbsubs_peduncles <-
ggplot(peduncles_urbsubs_02_pred) +
  labs(x = "Urbanization Score",
       y = "Inflorescences",
       color = "Transect",
       fill = "Transect") +
  ylim(0, NA) +
  xlim(4, -2) +
  theme_1() +
  rep_geoms2 +

# adding stats from ANOVA
           ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.97,
                    label = paste0(" Urb. Score: p = ", tidy_anova(repr.tr.m8_u) %>%
dplyr::filter(Predictor == "Urbanization Score") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.88,
                    label = paste0(" Subtransect: p = ", tidy_anova(repr.tr.m8_u) %>%
dplyr::filter(Predictor == "Subtransect") %>%
dplyr::select(p))),
size = 4.5) +
  ggpp::geom_text_npc(aes(npcx = 0.05, npcy = 0.79,
                    label = paste0(" U x S: p = ", tidy_anova(repr.tr.m8_u) %>%
dplyr::filter(Predictor == "Urbanization Score x Subtransect") %>%
dplyr::select(p))),
size = 4.5)

ggpred_Q2.urbsubs_peduncles
```

# Combine plots into one figure
## Gradient / City_dist
```{r}
ggarrange(
addborder(ggpred_Q1.citydist_flsucc, "reproduction"),
addborder(ggpred_Q1.citydist_flowers, "reproduction"),
addborder(ggpred_Q1.citydist_flsize, "reproduction"),
addborder(ggpred_Q1.citydist_fltime, "reproduction"),
addborder(ggpred_Q1.citydist_flstart, "reproduction"),
addborder(ggpred_Q1.citydist_poll, "reproduction"),
addborder(ggpred_Q1.citydist_pods, "reproduction"),
addborder(ggpred_Q1.citydist_firstpods, "reproduction"),
addborder(ggpred_Q1.citydist_peduncles, "reproduction") +
            font("x.text"),
          ncol = 3,
          nrow = 3,
          align = "hv",
          labels = list("A", "B", "C", "D", "E", "F", "G", "H", "I"),
          font.label = (size =16),
          common.legend = T,
          legend = "top") %T>%
  plot

dev.copy2pdf(file = here::here("./Figures_Tables/Regressions/1yr_mods/Reproduction/Q1_grad_citydist_Reproduction.pdf"),
             width = 12, height = 9.5)
```

## Gradient / Urbanization Score
```{r}
ggarrange(
addborder(ggpred_Q1.urbscore_flsucc, "reproduction"),
addborder(ggpred_Q1.urbscore_flowers, "reproduction"),
addborder(ggpred_Q1.urbscore_flsize, "reproduction"),
addborder(ggpred_Q1.urbscore_fltime, "reproduction"),
addborder(ggpred_Q1.urbscore_flstart, "reproduction"),
addborder(ggpred_Q1.urbscore_poll, "reproduction"),
addborder(ggpred_Q1.urbscore_pods, "reproduction"),
addborder(ggpred_Q1.urbscore_firstpods, "reproduction"),
addborder(ggpred_Q1.urbscore_peduncles, "reproduction") +
            font("x.text"),
          ncol = 3,
          nrow = 3,
          align = "hv",
          labels = list("A", "B", "C", "D", "E", "F", "G", "H", "I"),
          font.label = (size =16),
          common.legend = T,
          legend = "top") %T>%
  plot

dev.copy2pdf(file = here::here("./Figures_Tables/Regressions/1yr_mods/Reproduction/Q1_grad_urbscore_Reproduction.pdf"),
             width = 12, height = 9.5)
```

## Urb Subtransects / City_dist
```{r}
ggarrange(
  addborder(ggpred_Q2.citydist_succ, "reproduction"),
  addborder(ggpred_Q2.citydist_flowers, "reproduction"),
  addborder(ggpred_Q2.citydist_flsize, "reproduction"),
  addborder(ggpred_Q2.citydist_fltime, "reproduction"),
  addborder(ggpred_Q2.citydist_flstart, "reproduction"),
  addborder(ggpred_Q2.citydist_poll, "reproduction"),
  addborder(ggpred_Q2.citydist_pods, "reproduction"),
  addborder(ggpred_Q2.citydist_firstpods, "reproduction"),
  addborder(ggpred_Q2.citydist_peduncles, "reproduction") +
            font("x.text"),
          ncol = 3,
          nrow = 3,
          align = "hv",
          labels = list("A", "B", "C", "D", "E", "F", "G", "H", "I"),
          font.label = (size =16),
          common.legend = T,
          legend = "top") %T>%
  plot

dev.copy2pdf(file = here::here("./Figures_Tables/Regressions/1yr_mods/Reproduction/Q2_urbsubs_citydist_Reproduction.pdf"),
             width = 12, height = 9.5)
```

## Urb Subtransects / Urbanization Score
```{r}
ggarrange(
addborder(ggpred_Q2.urbsubs_flsucc, "reproduction"),
addborder(ggpred_Q2.urbsubs_flowers, "reproduction"),
addborder(ggpred_Q2.urbsubs_flsize, "reproduction"),
addborder(ggpred_Q2.urbsubs_fltime, "reproduction"),
addborder(ggpred_Q2.urbsubs_flstart, "reproduction"),
addborder(ggpred_Q2.urbsubs_poll, "reproduction"),
addborder(ggpred_Q2.urbsubs_pods, "reproduction"),
addborder(ggpred_Q2.urbscore_firstpods, "reproduction"),
addborder(ggpred_Q2.urbsubs_peduncles, "reproduction") +
            font("x.text"),
          ncol = 3,
          nrow = 3,
          align = "hv",
          labels = list("A", "B", "C", "D", "E", "F", "G", "H", "I"),
          font.label = (size =16),
          common.legend = T,
          legend = "top") %T>%
  plot


dev.copy2pdf(file = here::here("./Figures_Tables/Regressions/1yr_mods/Reproduction/Q2_urbsubs_urbscore_Reproduction.pdf"),
             width = 12, height = 9.5)
```

