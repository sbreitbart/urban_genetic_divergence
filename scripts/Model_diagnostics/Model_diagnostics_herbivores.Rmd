# Load libraries & functions
```{r}
source("libraries.R")
source("functions.R")
```

# Import data
```{r}
herbivores_all <- read.csv(here::here("./data/Joined_annual_data/herbivores.csv")) %>%
  dplyr::select(., -1) %>%
  dplyr::mutate_at(vars(c("Population",
                          "Family",
                          "Replicate",
                          "Block",
                          "Transect_ID",
                          "Sample",
                          "Patch_ID",
                          "Urb_Rur",
                          "Year",
                          "Surveyor",
                          "Date")),
                   as.character) %>%
    dplyr::mutate_at(vars(c("Population",
                            "Family",
                            "Replicate",
                            "Block",
                            "Transect_ID",
                            "Sample",
                            "Patch_ID",
                            "Urb_Rur",
                            "Year",
                            "Surveyor",
                          "Date")),
                     as.factor)

str(herbivores_all)
```

# Create subset
```{r}
# filter out herbivores not surveyed in 2021
# Herbivores surveyed in 2020-2021: Monarchs, L. asclepiadis, L. clivicollis
herbivores <- herbivores_all %>%
  dplyr::select(c(1:7, 10, 13, 19, 22:Surveyor))%>%
  dplyr::mutate(Fam_uniq = as.factor(paste0(Population, "_", Family))) %>%

# Take mean of two sampling events
  dplyr::group_by(Population, Row, Column, Block, Family, Replicate, Year) %>%
  dplyr::summarise(Monarch_Quantity_Observed = mean(Monarch_Quantity_Observed, na.rm = T),
                   Liriomyza_asclepiadis = mean(Liriomyza_asclepiadis, na.rm = T),
                   Labidomera_clivicollis = mean(Labidomera_clivicollis, na.rm = T),
                   Transect_ID = first(Transect_ID),
                   City_dist = first(City_dist),
                   Urb_Rur = first(Urb_Rur),
                   Urb_score = first(Urb_score),
                   Fam_uniq = first(Fam_uniq)) %>%
  as.data.frame()
                   
str(herbivores)
```

# Diagnostics
## Monarchs
### Gradient
#### City_dist
```{r}
monarch_gr_city_m1 <- glmmTMB(Monarch_Quantity_Observed ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist,
              data = herbivores,
              family = nbinom2,
              REML = F) 

# performance::check_model(monarch_gr_city_m1) # looks fine
# car::Anova(monarch_gr_city_m1)


# # test for gxe
# gxe_test_mon1 <- glmmTMB(Monarch_Quantity_Observed ~
#                                 (1|Population/Family) +
#                                 Year +
#                                 City_dist*Block,
#               data = herbivores,
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_mon1, monarch_gr_city_m1) # gxe mod best
# car::Anova(monarch_gr_city_m1, type = "III") # block sig here, not in gxe mod
# car::Anova(gxe_test_mon1, type = "III") # block*city NOT sig
```

#### Urb_score
```{r}
monarch_gr_usc_m1 <- glmmTMB(Monarch_Quantity_Observed ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score,
              data = herbivores,
              family = nbinom2,
              REML = F) 

# performance::check_model(monarch_gr_usc_m1) # looks fine


# # test for gxe
# gxe_test_mon2 <- glmmTMB(Monarch_Quantity_Observed ~
#                                 (1|Population/Family) +
#                                 Year +
#                                 Urb_score*Block,
#               data = herbivores,
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_mon2, monarch_gr_usc_m1) # gxe mod best
# car::Anova(monarch_gr_usc_m1, type = "III") # qual identical results
# car::Anova(gxe_test_mon2, type = "III") # block*urb_score NOT sig
```

### Urban Subtransects
#### City_dist
```{r}
# Full model
monarch_urbsubs_city_m1 <- glmmTMB(Monarch_Quantity_Observed ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist * Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(monarch_urbsubs_city_m1)


# MAIN EFFECTS MODEL
# this won't converge unless I remove both block and year
monarch_urbsubs_city_m2 <- glmmTMB(Monarch_Quantity_Observed ~
                          #      Block +
                                (1|Population/Family) +
                         #       Year +
                                City_dist + Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(monarch_urbsubs_city_m2) # looks fine

# Makes sense that m2 is better because it has three fewer effects in it, but this anova also confirms that there's no interaction between city_dist and transect, so I'll use the reduced model as the best one.
# car::Anova(monarch_urbsubs_city_m1, type = "III")
# AIC(monarch_urbsubs_city_m1,
#     monarch_urbsubs_city_m2) # m2 better


# # test for gxe
# gxe_test_mon3 <- glmmTMB(Monarch_Quantity_Observed ~
#                                 Block:City_dist +
#                                 (1|Population/Family) +
#                             #    Year +
#                                 City_dist + Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Transect_ID != "Rural"),
#               family = nbinom2,
#               REML = F)
# 
# # using m2 here
# test_gxe(gxe_test_mon3, monarch_urbsubs_city_m1) # stat equiv. Not getting AIC for reg model so just compared manually
# car::Anova(monarch_urbsubs_city_m2, type = "II") # city_dist sig here, marg sig in gxe mod
# car::Anova(gxe_test_mon3, type = "III") # block*city NOT sig
```

#### Urb_score
```{r}
# Full model
monarch_urbsubs_usc_m1 <- glmmTMB(Monarch_Quantity_Observed ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score * Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(monarch_urbsubs_usc_m1)


# MAIN EFFECTS MODEL
monarch_urbsubs_usc_m2 <- glmmTMB(Monarch_Quantity_Observed ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score + Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(monarch_urbsubs_usc_m2) # looks fine
# AIC(monarch_urbsubs_usc_m1,
#     monarch_urbsubs_usc_m2) # m2 better but <2 AIC apart


# # test for gxe
# gxe_test_mon4 <- glmmTMB(Monarch_Quantity_Observed ~
#                                 Block*Urb_score +
#                                 (1|Population/Family) +
#                                 Year +
#                                 Urb_score * Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Transect_ID != "Rural"),
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_mon4, monarch_urbsubs_usc_m1) # stat equiv
# car::Anova(monarch_urbsubs_usc_m1, type = "III")
# car::Anova(gxe_test_mon4, type = "III") # block*urb_score is marg sig (p = 0.08731)
# 
# 
# 
# # compare ranovas
# # GxE MOD-----
# #   test family
# #     large mod
# lgmod1 <- glmer.nb(Monarch_Quantity_Observed ~
#               #    Year +
#                   (1|Population) +
#                   (1|Population:Fam_uniq) +
#                   Urb_score*Block +
#                 Urb_score*Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Year == "2021" &
#                                 Transect_ID != "Rural"),
#               control=glmerControl(optimizer="bobyqa",
#                              optCtrl=list(maxfun=2e5)),
#                             na.action = na.exclude
#               )
# 
# #     small mod 1
# smmod1 <- glmer.nb(Monarch_Quantity_Observed ~
#               #    Year +
#                   (1|Population) +
#                   Urb_score*Block +
#                 Urb_score*Transect_ID,
#                 data = herbivores %>%
#                 dplyr::filter(Year == "2021" &
#                                 Transect_ID != "Rural"),
#               control=glmerControl(optimizer="bobyqa",
#                              optCtrl=list(maxfun=2e5)),
#                             na.action = na.exclude
#               )
# 
# PBmodcomp(lgmod1, smmod1, seed = 45, nsim = 10) # p = 1
# 
# # test pop
# #     small mod 2
# smmod2 <- glmer.nb(Monarch_Quantity_Observed ~
#               #    Year +
#                   (1|Population:Fam_uniq) +
#                   Urb_score*Block +
#                 Urb_score*Transect_ID,
#                 data = herbivores %>%
#                 dplyr::filter(Year == "2021" &
#                                 Transect_ID != "Rural"),
#               control=glmerControl(optimizer="bobyqa",
#                              optCtrl=list(maxfun=2e5)),
#                             na.action = na.exclude
#               )
# 
# PBmodcomp(lgmod1, smmod2, seed = 45, nsim = 10) # p > 0.5
# 
# 
# # REG MOD-----
# #   test family
# #     large mod
# lgmod1.reg <- glmer.nb(Monarch_Quantity_Observed ~
#               #    Year +
#                   (1|Population) +
#                   (1|Population:Fam_uniq) +
#                   Urb_score*Transect_ID + Block,
#                 data = herbivores %>%
#                 dplyr::filter(Year == "2021" &
#                                 Transect_ID != "Rural"),
# 
#               control=glmerControl(optimizer="bobyqa",
#                              optCtrl=list(maxfun=2e5)),
#                             na.action = na.exclude
#               )
# 
# #     small mod 1
# smmod1.reg <- glmer.nb(Monarch_Quantity_Observed ~
#               #    Year +
#                   (1|Population) +
#                   Urb_score*Transect_ID + Block,
#                 data = herbivores %>%
#                 dplyr::filter(Year == "2021" &
#                                 Transect_ID != "Rural"),
# 
#               control=glmerControl(optimizer="bobyqa",
#                              optCtrl=list(maxfun=2e5)),
#                             na.action = na.exclude
#               )
# 
# PBmodcomp(lgmod1.reg, smmod1.reg, seed = 45, nsim = 10) # p = 1
# 
# # test pop
# #     small mod 2
# smmod2.reg <- glmer.nb(Monarch_Quantity_Observed ~
#              #     Year +
#                   (1|Population:Fam_uniq) +
#                   Urb_score*Transect_ID + Block,
#                 data = herbivores %>%
#                 dplyr::filter(Year == "2021" &
#                                 Transect_ID != "Rural"),
# 
#               control=glmerControl(optimizer="bobyqa",
#                              optCtrl=list(maxfun=2e5)),
#                             na.action = na.exclude
#              )
# 
# 
# PBmodcomp(lgmod1.reg, smmod2.reg, seed = 45, nsim = 10) # p = 1
# 
# # mod comparison-----
# # qualitatively identical so I'll keep using regular model.

```


## Liriomyza asclepiadis
### Gradient
#### City_dist
```{r}
asclepiadis_gr_city_m1 <- glmmTMB(Liriomyza_asclepiadis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist,
              data = herbivores,
              family = nbinom2,
              REML = F)

# performance::check_model(asclepiadis_gr_city_m1)


# # test for gxe
# gxe_test_ascl1 <- glmmTMB(Liriomyza_asclepiadis ~
#                                 (1|Population/Family) +
#                                 Year +
#                                 City_dist*Block,
#               data = herbivores,
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_ascl1, asclepiadis_gr_city_m1) # gxe mod best
# car::Anova(asclepiadis_gr_city_m1, type = "III") # qual identical to gxe mod
# car::Anova(gxe_test_ascl1, type = "III") # block*city NOT sig
```

#### Urb_score
```{r}
asclepiadis_gr_usc_m1 <- glmmTMB(Liriomyza_asclepiadis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score,
              data = herbivores,
              family = nbinom2,
              REML = F) 

# performance::check_model(asclepiadis_gr_usc_m1)

# # test for gxe
# gxe_test_ascl2 <- glmmTMB(Liriomyza_asclepiadis ~
#                                 (1|Population/Family) +
#                                 Year +
#                                 Urb_score*Block,
#               data = herbivores,
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_ascl2, asclepiadis_gr_usc_m1) # gxe mod best
# car::Anova(asclepiadis_gr_usc_m1, type = "III") # qual identical to gxe mod
# car::Anova(gxe_test_ascl2, type = "III") # block*city NOT sig
```

### Urban Subtransects
#### City_dist
```{r}
# Full model
asclepiadis_urbsubs_city_m1 <- glmmTMB(Liriomyza_asclepiadis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist * Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(asclepiadis_urbsubs_city_m1)


# MAIN EFFECTS MODEL
asclepiadis_urbsubs_city_m2 <- glmmTMB(Liriomyza_asclepiadis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist + Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(asclepiadis_urbsubs_city_m2)
# AIC(asclepiadis_urbsubs_city_m1,
#     asclepiadis_urbsubs_city_m2) # m2 better but <2 AIC apart
#     
#     
# # test for gxe
# gxe_test_ascl3 <- glmmTMB(Liriomyza_asclepiadis ~
#                                 Block*City_dist +
#                                 (1|Population/Family) +
#                                 Year +
#                                 City_dist * Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Transect_ID != "Rural"),
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_ascl3, asclepiadis_urbsubs_city_m1) # gxe mod best
# car::Anova(asclepiadis_urbsubs_city_m1, type = "III") # qual identical
# car::Anova(gxe_test_ascl3, type = "III") # block*city NOT sig
```

#### Urb_score
```{r}
# Full model
asclepiadis_urbsubs_usc_m1 <- glmmTMB(Liriomyza_asclepiadis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score * Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F)

# performance::check_model(asclepiadis_urbsubs_usc_m1)


# MAIN EFFECTS MODEL
asclepiadis_urbsubs_usc_m2 <- glmmTMB(Liriomyza_asclepiadis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score + Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural"),
              family = nbinom2,
              REML = F) 

# performance::check_model(asclepiadis_urbsubs_usc_m2)
# AIC(asclepiadis_urbsubs_usc_m1,
#     asclepiadis_urbsubs_usc_m2) # m2 better but <2 AIC apart

    
# # test for gxe
# gxe_test_ascl4 <- glmmTMB(Liriomyza_asclepiadis ~
#                                 Block*Urb_score +
#                                 (1|Population/Family) +
#                                 Year +
#                                 Urb_score * Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Transect_ID != "Rural"),
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_ascl4, asclepiadis_urbsubs_usc_m1) # qual identical
# car::Anova(asclepiadis_urbsubs_usc_m1, type = "III") # qual identical
# car::Anova(gxe_test_ascl4, type = "III") # block*urbscore not sig
```


## Labidomera clivicollis
### Gradient
#### City_dist
```{r}
clivicollis_gr_city_m1 <- glmmTMB(Labidomera_clivicollis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist,
              data = herbivores %>%
                dplyr::filter(Labidomera_clivicollis < 9),
              family = nbinom2,
              REML = F) # remove outliers to maintain homogeneity of variance

# performance::check_model(clivicollis_gr_city_m1)


# # test for gxe
# gxe_test_cliv1 <- glmmTMB(Labidomera_clivicollis ~
#                                 (1|Population/Family) +
#                                 Year +
#                                 City_dist*Block,
#               data = herbivores %>%
#                 dplyr::filter(Labidomera_clivicollis < 9),
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_cliv1, clivicollis_gr_city_m1) # gxe mod best
# car::Anova(clivicollis_gr_city_m1, type = "III") # qual identical to gxe mod
# car::Anova(gxe_test_cliv1, type = "III") # block*city not sig
```

#### Urb_score
```{r}
clivicollis_gr_usc_m1 <- glmmTMB(Labidomera_clivicollis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score,
              data = herbivores %>%
                dplyr::filter(Labidomera_clivicollis < 9),
              family = nbinom2,
              REML = F) # remove outliers to maintain homogeneity of variance

# performance::check_model(clivicollis_gr_usc_m1)


# # test for gxe
# gxe_test_cliv2 <- glmmTMB(Labidomera_clivicollis ~
#                                 (1|Population/Family) +
#                                 Year +
#                                 Urb_score*Block,
#               data = herbivores %>%
#                 dplyr::filter(Labidomera_clivicollis < 9),
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_cliv2, clivicollis_gr_city_m1) # gxe mod best
# car::Anova(clivicollis_gr_city_m1, type = "III") # qual identical
# car::Anova(gxe_test_cliv2, type = "III") # urb score*block not sig
```

### Urban Subtransects
#### City_dist
```{r}
# Full model
clivicollis_urbsubs_city_m1 <- glmmTMB(Labidomera_clivicollis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist * Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural" &
                                Labidomera_clivicollis < 10), # remove outlier
              family = nbinom2,
              REML = F)

# performance::check_model(clivicollis_urbsubs_city_m1) 



# MAIN EFFECTS MODEL
clivicollis_urbsubs_city_m2 <- glmmTMB(Labidomera_clivicollis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                City_dist + Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural" & Labidomera_clivicollis < 10), # remove outlier
              family = nbinom2,
              REML = F)

# performance::check_model(clivicollis_urbsubs_city_m2) 
# AIC(clivicollis_urbsubs_city_m1,
#     clivicollis_urbsubs_city_m2) # m2 better but <2 AIC apart



# # test for gxe
# gxe_test_cliv3 <- glmmTMB(Labidomera_clivicollis ~
#                                 Block*City_dist +
#                                 (1|Population/Family) +
#                                 Year +
#                                 City_dist * Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Transect_ID != "Rural" &
#                                 Labidomera_clivicollis < 10), # remove outlier
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_cliv3, clivicollis_urbsubs_city_m1) # gxe mod best
# car::Anova(clivicollis_urbsubs_city_m1, type = "III") # city_dist sig in reg model, otherwise qual identical
# car::Anova(gxe_test_cliv3, type = "III") # city*block not sig
```

#### Urb_score
```{r}
# Full model
clivicollis_urbsubs_usc_m1 <- glmmTMB(Labidomera_clivicollis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score * Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural" &
                                Labidomera_clivicollis < 10), # remove outlier
              family = nbinom2,
              REML = F)

# performance::check_model(clivicollis_urbsubs_usc_m1) 



# MAIN EFFECTS MODEL
clivicollis_urbsubs_usc_m2 <- glmmTMB(Labidomera_clivicollis ~
                                Block +
                                (1|Population/Family) +
                                Year +
                                Urb_score + Transect_ID,
              data = herbivores %>%
                dplyr::filter(Transect_ID != "Rural" & Labidomera_clivicollis < 10), # remove outlier
              family = nbinom2,
              REML = F)

# performance::check_model(clivicollis_urbsubs_usc_m2) 
# AIC(clivicollis_urbsubs_usc_m1,
#     clivicollis_urbsubs_usc_m2) # m2 better but <2 AIC apart



# # test for gxe
# gxe_test_cliv4 <- glmmTMB(Labidomera_clivicollis ~
#                                 Block*Urb_score +
#                                 (1|Population/Family) +
#                                 Year +
#                                 Urb_score * Transect_ID,
#               data = herbivores %>%
#                 dplyr::filter(Transect_ID != "Rural" &
#                                 Labidomera_clivicollis < 10), # remove outlier
#               family = nbinom2,
#               REML = F)
# 
# test_gxe(gxe_test_cliv4, clivicollis_urbsubs_usc_m1) # gxe mod best
# car::Anova(clivicollis_urbsubs_usc_m1, type = "III") # qual identical
# car::Anova(gxe_test_cliv4, type = "III") # urb score*block not sig
```

# Models for use in analysis
## Monarchs
```{r}
monarch_mods <- list(

## City_dist / gradient
monarch_gr_city_m1 ,

## Urbanization score / gradient
monarch_gr_usc_m1 ,

## City_dist / urban subtransects
monarch_urbsubs_city_m1, # Qualitatively identical model (<2 AIC away)
monarch_urbsubs_city_m2, # Best model

## Urbanization score  / urban subtransects
monarch_urbsubs_usc_m1, # Qualitatively identical model (<2 AIC away)
monarch_urbsubs_usc_m2 # Best model

)

names(monarch_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_alt",
                     "Usc_urbsubs_best")
```

## L. asclepiadis
```{r}
asclepiadis_mods <- list(

## City_dist / gradient
asclepiadis_gr_city_m1 ,

## Urbanization score / gradient
asclepiadis_gr_usc_m1 ,

## City_dist / urban subtransects
asclepiadis_urbsubs_city_m1, # Qualitatively identical model (<2 AIC away)
asclepiadis_urbsubs_city_m2, # Best model

## Urbanization score  / urban subtransects
asclepiadis_urbsubs_usc_m1, # Qualitatively identical model (<2 AIC away)
asclepiadis_urbsubs_usc_m2 # Best model

)

names(asclepiadis_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_alt",
                     "Usc_urbsubs_best")
```

## L. clivicollis
```{r}
clivicollis_mods <- list(

## City_dist / gradient
clivicollis_gr_city_m1 ,

## Urbanization score / gradient
clivicollis_gr_usc_m1 ,

## City_dist / urban subtransects
clivicollis_urbsubs_city_m1, # Qualitatively identical model (<2 AIC away)
clivicollis_urbsubs_city_m2, # Best model

## Urbanization score  / urban subtransects
clivicollis_urbsubs_usc_m1, # Qualitatively identical model (<2 AIC away)
clivicollis_urbsubs_usc_m2 # Best model

)

names(clivicollis_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_alt",
                     "Usc_urbsubs_best")
```
# Create separate lists of best vs. alt models for city_dist vs urb_score
## Monarchs
```{r}
## Best
### City_dist
monarch_mods_best_c <- monarch_mods[c(1,4)]

### Urb_score
monarch_mods_best_u <- monarch_mods[c(2,6)]

## Alt
### City_dist
monarch_mods_alt_c <- monarch_mods[3]

### Urb_score
monarch_mods_alt_u <- monarch_mods[5]
```

## L. asclepiadis
```{r}
## Best
### City_dist
asclepiadis_mods_best_c <- asclepiadis_mods[c(1,4)]

### Urb_score
asclepiadis_mods_best_u <- asclepiadis_mods[c(2,6)]

## Alt
### City_dist
asclepiadis_mods_alt_c <- asclepiadis_mods[3]

### Urb_score
asclepiadis_mods_alt_u <- asclepiadis_mods[5]
```


## L. clivicollis
```{r}
## Best
### City_dist
clivicollis_mods_best_c <- clivicollis_mods[c(1,4)]

### Urb_score
clivicollis_mods_best_u <- clivicollis_mods[c(2,6)]

## Alt
### City_dist
clivicollis_mods_alt_c <- clivicollis_mods[3]

### Urb_score
clivicollis_mods_alt_u <- clivicollis_mods[5]

```

# Create final list of all models
```{r}
all_models <- list(
monarch_mods         , 
asclepiadis_mods    ,
clivicollis_mods)   

names(all_models) <- c(
"monarch_mods"         ,
"asclepiadis_mods"    ,
"clivicollis_mods")


```

