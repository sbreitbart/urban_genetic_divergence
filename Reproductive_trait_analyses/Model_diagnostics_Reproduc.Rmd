# Load libraries & functions
```{r}
source("libraries.R")
source("functions.R")
```

# Import data
```{r}
reproduc <- read.csv(here::here("./Joined_annual_data/reproductive.csv"), na.strings=c("NO PLANT", "none", "NA"), blank.lines.skip=TRUE, header=TRUE, sep=",") %>%
  dplyr::select(., -1)%>%
  dplyr::mutate_at(vars(c("Population", "Family", "Replicate", "Block")), as.character) %>%
    dplyr::mutate_at(vars(c("Population", "Family", "Replicate", "Block")), as.factor)

flowering <- read.csv(here::here("./Joined_annual_data/flowering.csv"), na.strings=c("NO PLANT", "none", "NA"), blank.lines.skip=TRUE, header=TRUE, sep=",") %>%
  dplyr::select(., -1)%>%
  dplyr::mutate_at(vars(c("Population", "Family", "Replicate", "Block")), as.character) %>%
    dplyr::mutate_at(vars(c("Population", "Family", "Replicate", "Block")), as.factor) %>%
    dplyr::mutate_at(vars(c(Date_oldest_inflor_flower,
                            Date_youngest_inflor_flower,
                            Date_first_follicle_2in)),
                     as.Date,
                     format = '%m/%d/%Y') %>%
  dplyr::mutate(flowering_time = Date_youngest_inflor_flower-Date_oldest_inflor_flower + 1) # if I don't add 1, then it will say some plants flowered for 0 days
%>%
  relocate(flowering_time,
           .before = Date_first_follicle_2in)
# 
# reproduc %<>%
#   dplyr::mutate(Fam_uniq = paste0(Population, "_", Family))
# 
# flowering %<>%
#   dplyr::mutate(Fam_uniq = paste0(Population, "_", Family))

```

# Model diagnostics
## Flowering success
### Gradient
#### City_dist
```{r}
flsucc_gr_city1 <- glmmTMB(Flowered ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             City_dist,
  data = reproduc,
  family = binomial(link = "logit"))


plot(DHARMa::simulateResiduals(flsucc_gr_city1)) # looks great!
```

#### Urb_score
```{r}
flsucc_gr_usc1 <- glmmTMB(Flowered ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             Urb_score,
  data = reproduc,
  family = binomial(link = "logit"))


plot(DHARMa::simulateResiduals(flsucc_gr_usc1)) # looks great!
```

### Urban subtransects
#### City_dist
```{r}
flsucc_urbsubs_city1 <- glmmTMB(Flowered ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             City_dist * Transect_ID,
  data = reproduc %>%
    dplyr::filter(Transect_ID != "Rural"),
  family = binomial(link = "logit"))


plot(DHARMa::simulateResiduals(flsucc_urbsubs_city1)) # looks great!


## MAIN EFFECTS
flsucc_urbsubs_city1_ME <- glmmTMB(Flowered ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             City_dist + Transect_ID,
  data = reproduc %>%
    dplyr::filter(Transect_ID != "Rural"),
  family = binomial(link = "logit"))


plot(DHARMa::simulateResiduals(flsucc_urbsubs_city1_ME)) # looks great!

AIC(flsucc_urbsubs_city1, flsucc_urbsubs_city1_ME) # ME model best but <2 AIC away from full
```

#### Urb_score
```{r}
flsucc_urbsubs_usc1 <- glmmTMB(Flowered ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             Urb_score * Transect_ID,
  data = reproduc %>%
    dplyr::filter(Transect_ID != "Rural"),
  family = binomial(link = "logit"))


plot(DHARMa::simulateResiduals(flsucc_urbsubs_usc1)) # looks great!


## MAIN EFFECTS
flsucc_urbsubs_usc1_ME <- glmmTMB(Flowered ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             Urb_score + Transect_ID,
  data = reproduc %>%
    dplyr::filter(Transect_ID != "Rural"),
  family = binomial(link = "logit"))


plot(DHARMa::simulateResiduals(flsucc_urbsubs_usc1_ME)) # looks great!

AIC(flsucc_urbsubs_usc1, flsucc_urbsubs_usc1_ME) # ME model best but <2 AIC away from full

```


## Flower count
### Mean flowers/inflorescence
#### Gradient
##### City_dist
```{r}
fl_per_infl_gr_city1 <- glmmTMB(mean_flower_count ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist, 
                                        data = flowering)

plot(DHARMa::simulateResiduals(fl_per_infl_gr_city1)) # looks great

```

##### Urb_score
```{r}
fl_per_infl_gr_usc1 <- glmmTMB(mean_flower_count ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          Urb_score, 
                                        data = flowering)

plot(DHARMa::simulateResiduals(fl_per_infl_gr_usc1)) # looks great

```


#### Urban Subtransects
##### City_dist
```{r}
fl_per_infl_urbsubs_city1 <- glmmTMB(mean_flower_count ~
                                          # (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist * Transect_ID, 
                                        data = flowering %>%
                                       dplyr::filter(Transect_ID != "Rural")) # doesn't converge unless I remove block

plot(DHARMa::simulateResiduals(fl_per_infl_urbsubs_city1)) # looks great

## MAIN EFFECTS
fl_per_infl_urbsubs_city1_ME <- glmmTMB(mean_flower_count ~
                                          # (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist + Transect_ID, 
                                        data = flowering %>%
                                       dplyr::filter(Transect_ID != "Rural")) # doesn't converge unless I remove block

plot(DHARMa::simulateResiduals(fl_per_infl_urbsubs_city1_ME)) # looks great

AIC(fl_per_infl_urbsubs_city1, fl_per_infl_urbsubs_city1_ME) # ME model better but <2 AIC away

```

##### Urb_score
```{r}
fl_per_infl_urbsubs_usc1 <- glmmTMB(mean_flower_count ~
                                          # (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          Urb_score * Transect_ID, 
                                        data = flowering %>%
                                       dplyr::filter(Transect_ID != "Rural")) # doesn't converge unless I remove block

plot(DHARMa::simulateResiduals(fl_per_infl_urbsubs_usc1)) # looks great



## MAIN EFFECTS
fl_per_infl_urbsubs_usc1_ME <- glmmTMB(mean_flower_count ~
                                          # (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          Urb_score + Transect_ID, 
                                        data = flowering %>%
                                       dplyr::filter(Transect_ID != "Rural")) # doesn't converge unless I remove block

plot(DHARMa::simulateResiduals(fl_per_infl_urbsubs_usc1_ME)) # looks great

AIC(fl_per_infl_urbsubs_usc1, fl_per_infl_urbsubs_usc1_ME) # ME model better but <2 AIC away

```
### Total flowers/plant
#### Gradient
##### City_dist
```{r}
flowers_gr_city1 <- glmmTMB(total_flower_count ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist, 
                                        data = flowering,
                            family = poisson())

plot(DHARMa::simulateResiduals(flowers_gr_city1)) # looks great

```

##### Urb_score
```{r}
flowers_gr_usc1 <- glmmTMB(total_flower_count ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          Urb_score, 
                                        data = flowering,
                            family = poisson())

plot(DHARMa::simulateResiduals(flowers_gr_usc1)) # looks great

```


#### Urban Subtransects
##### City_dist
```{r}
flowers_urbsubs_city1 <- glmmTMB(total_flower_count ~
                                          # (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist * Transect_ID, 
                                        data = flowering %>%
                                   dplyr::filter(Transect_ID != "Rural"),
                            family = poisson()) # doesn't converge unless I remove block

plot(DHARMa::simulateResiduals(flowers_urbsubs_city1)) # looks great


## MAIN EFFECTS
flowers_urbsubs_city1_ME <- glmmTMB(total_flower_count ~
                                          # (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist + Transect_ID, 
                                        data = flowering %>%
                                   dplyr::filter(Transect_ID != "Rural"),
                            family = poisson()) # doesn't converge unless I remove block

plot(DHARMa::simulateResiduals(flowers_urbsubs_city1_ME)) # looks great


AIC(flowers_urbsubs_city1, flowers_urbsubs_city1_ME) # ME model better but <2 AIC from full
```

##### Urb_score
```{r}
flowers_urbsubs_usc1 <- glmmTMB(total_flower_count ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          Urb_score * Transect_ID, 
                                        data = flowering %>%
                                   dplyr::filter(Transect_ID != "Rural"),
                            family = poisson()) 

plot(DHARMa::simulateResiduals(flowers_urbsubs_usc1)) # looks great


## MAIN EFFECTS
flowers_urbsubs_usc1_ME <- glmmTMB(total_flower_count ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          Urb_score + Transect_ID, 
                                        data = flowering %>%
                                   dplyr::filter(Transect_ID != "Rural"),
                            family = poisson()) 

plot(DHARMa::simulateResiduals(flowers_urbsubs_usc1_ME)) # looks great


AIC(flowers_urbsubs_usc1, flowers_urbsubs_usc1_ME) # ME model better but <2 AIC from full
```
## Mean flower size/inflorescence
### Gradient
#### City_dist
```{r}
flsize_gr_city1 <- glmmTMB(Overall_mean ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             City_dist, 
                           data = flowering)

plot(DHARMa::simulateResiduals(flsize_gr_city1)) # looks great
```

#### Urb_score
```{r}
flsize_gr_usc1 <- glmmTMB(Overall_mean ~
                         #    (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             Urb_score, 
                           data = flowering,
                          REML = F) # it runs with block included, but anova dones't work, so I'll remove block

plot(DHARMa::simulateResiduals(flsize_gr_usc1)) # looks great

car::Anova(flsize_gr_usc1)
```

### Urban Subtransects
#### City_dist
```{r}
flsize_urbsubs_city1 <- glmmTMB(Overall_mean ~
                             #(1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             City_dist * Transect_ID, 
                           data = flowering %>%
                             dplyr::filter(Transect_ID != "Rural")) # doesn't converge with block included

plot(DHARMa::simulateResiduals(flsize_urbsubs_city1)) # looks great

## MAIN EFFECTS
flsize_urbsubs_city1_ME <- glmmTMB(Overall_mean ~
                             #(1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             City_dist + Transect_ID, 
                           data = flowering %>%
                             dplyr::filter(Transect_ID != "Rural")) # doesn't converge with block included

plot(DHARMa::simulateResiduals(flsize_urbsubs_city1_ME)) # looks great

AIC(flsize_urbsubs_city1, flsize_urbsubs_city1_ME) # ME best but <2 AIC from full
```

#### Urb_score
```{r}
flsize_urbsubs_usc1 <- glmmTMB(Overall_mean ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             Urb_score * Transect_ID, 
                           data = flowering %>%
                             dplyr::filter(Transect_ID != "Rural")) 

plot(DHARMa::simulateResiduals(flsize_urbsubs_usc1)) # looks great

## MAIN EFFECTS
flsize_urbsubs_usc1_ME <- glmmTMB(Overall_mean ~
                             (1|Block) +
                             (1|Year) +
                             (1|Population/Family) +
                             Urb_score + Transect_ID, 
                           data = flowering %>%
                             dplyr::filter(Transect_ID != "Rural"))

plot(DHARMa::simulateResiduals(flsize_urbsubs_usc1_ME)) # issues with predicted vs. observed residuals // quantiles
# DHARMa vignette says: "To remove this pattern, you would need to make the dispersion parameter dependent on a predictor (e.g. in JAGS), or apply a transformation on the data."
# -JAGS is a Bayesian software
# -I tried transforming the response and it doesn't completely solve the issue. Looking at the performance::check_model() plots below, I think this isn't much to worry about.

performance::check_model(flsize_urbsubs_usc1_ME)

AIC(flsize_urbsubs_usc1, flsize_urbsubs_usc1_ME) # full model best
```

## Flowering time
### Gradient
#### City_dist
```{r}
fl_time_gr_city1 <- glmmTMB(as.numeric(flowering_time) ~
                                          (1|Block) +
                                          (1|Year) +
                                          (1|Population/Family) +
                                          City_dist, 
                                        data = flowering,
                            family = poisson)

plot(DHARMa::simulateResiduals(fl_time_gr_city1)) # looks great
performance::check_model(fl_time_gr_city1)

car::Anova(fl_time_gr_city1)



```

## Pods
#### Gradient
##### City_dist
```{r}
# pods_gr_city1 <- glmmTMB(Pods ~
#                            (1|Block) +
#                            (1|Year) +
#                            (1|Population/Family) +
#                            City_dist, 
#                          data = flowering,
#                          family = poisson())
# 
# plot(DHARMa::simulateResiduals(pods_gr_city1)) # problem with residual vs predicted plot. Transformations (square, cube) don't help. Try negative binomial?

pods_gr_city1 <- glmmTMB(Pods ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist, 
                         data = flowering,
                         family = nbinom2)

plot(DHARMa::simulateResiduals(pods_gr_city1)) # issue persists with negbin1, but NOT negbinom2. nbinom1 is quasi-poisson and nbinom2 is negative binomial. So I'll stick with that

```

##### Urb_score
```{r}
# pods_gr_usc1.1 <- glmmTMB(Pods ~
#                            (1|Block) +
#                            (1|Year) +
#                            (1|Population/Family) +
#                            Urb_score,
#                          data = flowering,
#                          family = poisson())
# 
# plot(DHARMa::simulateResiduals(pods_gr_usc1.1)) # NO problem with residual vs predicted plot, unlike city_dist model. Try negative binomial just in case

pods_gr_usc1 <- glmmTMB(Pods ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist, 
                         data = flowering,
                         family = nbinom2)

plot(DHARMa::simulateResiduals(pods_gr_usc1)) # issue persists with negbin1, but NOT negbinom2. nbinom1 is quasi-poisson and nbinom2 is negative binomial. So I'll stick with that

# AIC(pods_gr_usc1.1, pods_gr_usc1) # neg bin model significantly lower AIC, so use that one

```

#### Urban Subtransects
##### City_dist
```{r}
# pods_urbsubs_city1 <- glmmTMB(Pods ~
#                            (1|Block) +
#                            (1|Year) +
#                            (1|Population/Family) +
#                            City_dist * Transect_ID,
#                          data = flowering %>%
#                            dplyr::filter(Transect_ID != "Rural"),
#                          family = poisson())
# 
# plot(DHARMa::simulateResiduals(pods_urbsubs_city1)) # problem with residual vs predicted plot and KS test. Transformations (square, cube) don't help. Try negative binomial?

pods_urbsubs_city1 <- glmmTMB(Pods ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist * Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(pods_urbsubs_city1)) # issue disappears with negbin1 AND negbinom2. nbinom1 is quasi-poisson and nbinom2 is negative binomial and I used NB2 above, So I'll stick with that


# MAIN EFFECTS MODEL
pods_urbsubs_city1_ME <- glmmTMB(Pods ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist + Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(pods_urbsubs_city1_ME)) # looks fine

AIC(pods_urbsubs_city1, pods_urbsubs_city1_ME) # full model lower AIC but <2 away
```

##### Urb_score
```{r}
# pods_urbsubs_usc1 <- glmmTMB(Pods ~
#                            (1|Block) +
#                            (1|Year) +
#                            (1|Population/Family) +
#                            Urb_score * Transect_ID,
#                          data = flowering %>%
#                            dplyr::filter(Transect_ID != "Rural"),
#                          family = poisson())
# 
# plot(DHARMa::simulateResiduals(pods_urbsubs_usc1)) # problem with residual vs predicted plot. Try negative binomial like w/prev plots

pods_urbsubs_usc1 <- glmmTMB(Pods^3 ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           Urb_score * Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(pods_urbsubs_usc1)) # issue persists with negbin1 AND negbinom2, but NOT after I square or cube-transform (latter looks best). nbinom1 is quasi-poisson and nbinom2 is negative binomial and I used NB2 above, So I'll stick with that

performance::check_model(pods_urbsubs_usc1)

# MAIN EFFECTS MODEL
pods_urbsubs_usc1_ME <- glmmTMB(Pods^3 ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           Urb_score + Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(pods_urbsubs_usc1_ME)) # looks fine

performance::check_model(pods_urbsubs_usc1_ME)

AIC(pods_urbsubs_usc1, pods_urbsubs_usc1_ME) # full model best but <2  AIC away
```

## Peduncles (Inflorescences)
#### Gradient
##### City_dist
```{r}
peduncles_gr_city1 <- glmmTMB(Peduncles ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist,
                         data = flowering,
                         family = poisson())

plot(DHARMa::simulateResiduals(peduncles_gr_city1)) # looks good

```

##### Urb_score
```{r}
peduncles_gr_usc1 <- glmmTMB(Peduncles ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           Urb_score,
                         data = flowering,
                         family = poisson())

plot(DHARMa::simulateResiduals(peduncles_gr_usc1)) # looks good

```

#### Urban Subtransects
##### City_dist
```{r}
# peduncles_urbsubs_city1 <- glmmTMB(Peduncles ~
#                            (1|Block) +
#                            (1|Year) +
#                            (1|Population/Family) +
#                            City_dist * Transect_ID,
#                          data = flowering %>%
#                            dplyr::filter(Transect_ID != "Rural"),
#                          family = poisson())
# 
# plot(DHARMa::simulateResiduals(peduncles_urbsubs_city1)) # issues with KS test and dispersion
# testDispersion(peduncles_urbsubs_city1)
# 
# performance::check_model(peduncles_urbsubs_city1)

# neg binomial- this works (nbinom1 doesn't)
peduncles_urbsubs_city1 <- glmmTMB(Peduncles^2 ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist * Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(peduncles_urbsubs_city1))

performance::check_model(peduncles_urbsubs_city1)


# MAIN EFFECTS MODEL
peduncles_urbsubs_city1_ME <- glmmTMB(Peduncles^2 ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           City_dist + Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(peduncles_urbsubs_city1_ME))

performance::check_model(peduncles_urbsubs_city1_ME)

AIC(peduncles_urbsubs_city1, peduncles_urbsubs_city1_ME) # ME model best but <2 AIC from full
```

##### Urb_score
```{r}
# neg binomial- nbinom2 has best results though residual vs predicted plot still has issues
peduncles_urbsubs_usc1 <- glmmTMB(Peduncles ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           Urb_score * Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(peduncles_urbsubs_usc1))
DHARMa::testOutliers(peduncles_urbsubs_usc1) # no outliers
performance::check_model(peduncles_urbsubs_usc1)
# "To remove this pattern, you would need to make the dispersion parameter dependent on a predictor (e.g. in JAGS), or apply a transformation on the data."
# -JAGS is a Bayesian software
# -I tried transforming the response and it doesn't completely solve the issue. Looking at the performance::check_model() plots above, I think this isn't much to worry about.


# MAIN EFFECTS MODEL
peduncles_urbsubs_usc1_ME <- glmmTMB(Peduncles ~
                           (1|Block) +
                           (1|Year) +
                           (1|Population/Family) +
                           Urb_score + Transect_ID,
                         data = flowering %>%
                           dplyr::filter(Transect_ID != "Rural"),
                         family = nbinom2)

plot(DHARMa::simulateResiduals(peduncles_urbsubs_usc1_ME)) # looks good

performance::check_model(peduncles_urbsubs_usc1_ME)

AIC(peduncles_urbsubs_usc1, peduncles_urbsubs_usc1_ME) # ME model best model
```

# Models for use in analysis
## Flowering success
```{r}
flsucc_mods <- list(

## City_dist / gradient
flsucc_gr_city1 ,

## Urbanization score / gradient
flsucc_gr_usc1 ,

## City_dist / urban subtransects
flsucc_urbsubs_city1, # Qualitatively identical model (<2 AIC away)
flsucc_urbsubs_city1_ME, # Best model

## Urbanization score  / urban subtransects
flsucc_urbsubs_usc1, # Qualitatively identical model (<2 AIC away)
flsucc_urbsubs_usc1_ME # Best model

)


names(flsucc_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_alt",
                     "Usc_urbsubs_best")
```

## Flowers per inflorescence
```{r}
fl_per_infl_mods <- list(

## City_dist / gradient
fl_per_infl_gr_city1 ,

## Urbanization score / gradient
fl_per_infl_gr_usc1 ,

## City_dist / urban subtransects
fl_per_infl_urbsubs_city1, # Qualitatively identical model (<2 AIC away)
fl_per_infl_urbsubs_city1_ME, # Best model

## Urbanization score  / urban subtransects
fl_per_infl_urbsubs_usc1, # Qualitatively identical model (<2 AIC away)
fl_per_infl_urbsubs_usc1_ME # Best model

)


names(fl_per_infl_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_alt",
                     "Usc_urbsubs_best")
```

## Flowers total
```{r}
flowers_mods <- list(

## City_dist / gradient
flowers_gr_city1 ,

## Urbanization score / gradient
flowers_gr_usc1 ,

## City_dist / urban subtransects
flowers_urbsubs_city1, # Qualitatively identical model (<2 AIC away)
flowers_urbsubs_city1_ME, # Best model

## Urbanization score  / urban subtransects
flowers_urbsubs_usc1, # Qualitatively identical model (<2 AIC away)
flowers_urbsubs_usc1_ME # Best model

)


names(flowers_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_alt",
                     "Usc_urbsubs_best")
```

## Flower size
```{r}
flsize_mods <- list(

## City_dist / gradient
flsize_gr_city1 ,

## Urbanization score / gradient
flsize_gr_usc1 ,

## City_dist / urban subtransects
flsize_urbsubs_city1, # Qualitatively identical model (<2 AIC away)
flsize_urbsubs_city1_ME, # Best model

## Urbanization score  / urban subtransects
flsize_urbsubs_usc1 # Best model
#flsize_urbsubs_usc1_ME  # >2 AIC from best model

)


names(flsize_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_best")
```

## Pods
```{r}
pods_mods <- list(

## City_dist / gradient
pods_gr_city1 ,

## Urbanization score / gradient
pods_gr_usc1 ,

## City_dist / urban subtransects
pods_urbsubs_city1, # Best model
pods_urbsubs_city1_ME, # Qualitatively identical model (<2 AIC away)

## Urbanization score  / urban subtransects
pods_urbsubs_usc1, # Best model
pods_urbsubs_usc1_ME # Qualitatively identical model (<2 AIC away)

)


names(pods_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_best",
                     "Usc_urbsubs_alt")
```

## Peduncles
```{r}
peduncles_mods <- list(

## City_dist / gradient
peduncles_gr_city1 ,

## Urbanization score / gradient
peduncles_gr_usc1 ,

## City_dist / urban subtransects
peduncles_urbsubs_city1, # Qualitatively identical model (<2 AIC away)
peduncles_urbsubs_city1_ME, # Best model

## Urbanization score  / urban subtransects
peduncles_urbsubs_usc1 #, # Best model
# peduncles_urbsubs_usc1_ME 

)


names(peduncles_mods) <- c("City_gr",
                     "Usc_gr",
                     "City_urbsubs_alt",
                     "City_urbsubs_best",
                     "Usc_urbsubs_best")
```

